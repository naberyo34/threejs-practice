<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="js/three.min.js"></script>
    <script src="js/loaders/MTLLoader.js"></script>
    <script src="js/loaders/OBJLoader.js"></script>
    <script>
      // ページの読み込みを待つ
      window.addEventListener("load", init);

      function init() {
        // サイズを指定
        const width = 960;
        const height = 540;

        // レンダラーを作成
        const renderer = new THREE.WebGLRenderer({
          canvas: document.querySelector("#myCanvas")
        });
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.setSize(width, height);

        // シーンを作成
        const scene = new THREE.Scene();

        // カメラを作成
        const camera = new THREE.PerspectiveCamera(
          20,
          width / height,
        );
        // カメラの初期座標を設定
        camera.position.set(2, 3, 10);

        // 環境光を追加
        const ambientLight = new THREE.AmbientLight(0xffffff);
        scene.add(ambientLight);

        // モデルデータの読み込み
        const mtlLoader = new THREE.MTLLoader();
        const objLoader = new THREE.OBJLoader();

        mtlLoader.load("./models/tama.mtl", materials => {
          materials.preload();

          const objLoader = new THREE.OBJLoader();
          objLoader.setMaterials(materials);

          objLoader.load("./models/tama.obj", function(obj) {
            const model = obj;
            const tick = () => {
              model.rotation.y += 0.02;
              renderer.render(scene, camera); // レンダリング
              requestAnimationFrame(tick);
            };
            scene.add(model);
            tick();
          });
        });
      }
    </script>
  </head>
  <body>
    <canvas id="myCanvas"></canvas>
  </body>
</html>
